<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Homework 10 | Converter</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/all.css">
</head>
<body>
    <header class="header">Конвертер валют</header>
    <main class="main">
        <form class="main__section">
            <article class="main__article">
                <div class="input-group">
                    <input class="input__field" type="text" name="fromCurrency" value="RUB" id="fromCurrency">
                    <label class="input__label" for="fromCurrency">Валюта 1</label>
                </div>
                <div class="input-group">
                    <input class="input__field" type="text" name="toCurrency" value="USD" id="toCurrency">
                    <label class="input__label" for="toCurrency">Валюта 2</label>
                </div>
                <div class="input-group">
                    <input class="input__field" type="text" name="amount" value="299" id="amount">
                    <label class="input__label" for="amount">Число</label>
                </div>
            </article>
            <article>
                <div class="resoult">
                    <p class="resoult__field"></p>
                </div>
                <div class="submit-btn-wrapper">
                    <button class="btn" type="submit">Отправить</button>
                </div>
            </article>
            <article>
                <a href="https://index.minfin.com.ua/reference/currency/code/">Коды валют</a>
            </article>
        </form>
    </main>
    <script>
        document.querySelector("button").addEventListener("click", async (e) => {
            e.preventDefault(); // cancel page reload
            let data = {
                toCurrency: document.querySelector("#toCurrency").value,
                fromCurrency: document.querySelector("#fromCurrency").value,
                amount: document.querySelector("#amount").value
            }
            try {
                const response = await fetch('/api/calc', {
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    method: 'POST',
                    body: JSON.stringify(data)
                })
                const resoult = await response.json();
                const value = Object.values(resoult)
                document.querySelector(".resoult__field").innerHTML = value
            } catch (error) {
                alert(error)
            }
        })
    </script>
</body>
</html>